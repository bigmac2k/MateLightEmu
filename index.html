<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HSML</title>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var c=document.getElementById("screen");
      var ctx=c.getContext("2d");
      var imgData=ctx.createImageData(40,16);

      var connection = new WebSocket('ws://127.0.0.1:8080/');
      connection.binaryType = 'arraybuffer';
      connection.onerror = function (error) {
        console.log('WSError: ' + error);
      };
      connection.onmessage = function(msg) {
        var data = new Uint8Array(msg.data);
        console.log('WSMessage received ' + data.length / 3 + ' pixels');
        for (var i = 0; i < data.length / 3; i += 1) {
          imgData.data[4 * i + 0]=data[3 * i + 0];
          imgData.data[4 * i + 1]=data[3 * i + 1];
          imgData.data[4 * i + 2]=data[3 * i + 2];
          imgData.data[4 * i + 3]=255;
        }
      ctx.putImageData(imgData,0,0);
      };
    });
  </script>
</head>
<body>
  <canvas id="screen" width="40", height="16", style="width:100%; height:100%"></canvas>
</body>
</html>
